{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Корзина — Tech Store</title>
    <link rel="stylesheet" href="{% static 'tech_store/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<header>
    <div class="techstore-title">Tech Store</div>
    <nav class="navbar">
        <a href="{% url 'home' %}" class="nav-item"><i class="fa-solid fa-house"></i> Главная</a>
        <a href="{% url 'catalog' %}" class="nav-item"><i class="fa-solid fa-list"></i> Каталог</a>
        {% if user.is_authenticated %}
            <span class="nav-item"><i class="fa-solid fa-user"></i> {{ user.username }}</span>
            <a href="{% url 'logout' %}" class="nav-item"><i class="fa-solid fa-right-from-bracket"></i> Выйти</a>
        {% else %}
            <a href="{% url 'login-short' %}" class="nav-item"><i class="fa-solid fa-right-to-bracket"></i> Войти</a>
            <a href="{% url 'register-short' %}" class="nav-item"><i class="fa-solid fa-user-plus"></i> Регистрация</a>
        {% endif %}
    </nav>
</header>

<main class="container" style="max-width: 900px; margin: 40px auto;">
    <h2>Корзина</h2>

    {% if order and order.items.all %}
        <div class="cart-list">
            {% for item in order.items.all %}
                <div class="cart-item" style="display:flex; gap:15px; margin-bottom:20px; background:#fff; padding:15px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
                    {% if item.product.image %}
                        <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" style="width:120px; height:120px; object-fit:cover; border-radius:5px;">
                    {% else %}
                        <div class="image-placeholder" style="width:120px; height:120px; background:#ccc; border-radius:5px;"></div>
                    {% endif %}
                    <div class="cart-info" style="display:flex; flex-direction:column; justify-content:space-between;">
                        <h3>{{ item.product.name }}</h3>
                        <p>Количество: {{ item.quantity }}</p>
                        <p>Цена за штуку: {{ item.price }} ₸</p>
                        <p><strong>Всего: {{ item.get_total }} ₸</strong></p>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="cart-total" style="text-align:right; margin-top:20px;">
            <h3>Итого к оплате: {{ order.get_total }} ₸</h3>
            <button class="catalog-btn"><i class="fa-solid fa-credit-card"></i> Оформить заказ</button>
        </div>
    {% else %}
        <p>Ваша корзина пуста.</p>
    {% endif %}
</main>
</body>
</html>
